{% load custom_filters %}
<!DOCTYPE html>
<html>

<head>
  <title>Filter Data</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

  <style>
    .table-container {
      overflow: auto;
      /* Add horizontal and/or vertical scrollbar */
      max-width: 100%;
      /* Ensure the container doesnâ€™t exceed the viewport width */
      max-height: 400px;
      /* Optional: limit the height of the container */

      box-shadow: 2px 2px 8px grey;
      margin-top: 50px;
    }
  </style>


</head>

<body>

  <h4 style="text-align: center; font-weight: bold; margin-top: 25px;">Filter Data and Report</h4>
  <form method="post" class="form-control mt-4">
    {% csrf_token %}
    <div>
      <div class="mb-3 filter-input" style="float: left; margin-left: 150px;">
        <label for="date_from" class="form-label">From Date:</label>
        <input type="date" id="date_from" name="date_from" class="form-control" value="{{ filters.date_from }}">
      </div>
      <div class="mb-3 filter-input" style="float: left; margin-left: 50px;">
        <label for="date_to" class="form-label">To Date:</label>
        <input type="date" id="date_to" name="date_to" class="form-control" value="{{ filters.date_to }}">
      </div>
      <div class="mb-3 filter-input" style="float: left; margin-left: 50px;">
        <label for="pin" class="form-label">PIN:</label>
        <input type="text" id="pin" name="pin" class="form-control" value="{{ filters.pin }}">
      </div>
      <div class="mb-3 filter-input" style="float: left; margin-left: 50px;">
        <label for="name" class="form-label">Name:</label>
        <input type="text" id="name" name="name" class="form-control" value="{{ filters.name }}">
      </div>
      <div class="mb-3 filter-input" style="float: right; margin-right: 150px;">
        <label for="i_card_number" class="form-label">I Card Number:</label>
        <input type="text" id="i_card_number" name="i_card_number" class="form-control"
          value="{{ filters.i_card_number }}">
      </div>
    </div>
    <div style="margin-top: 100px;">
      <div class="mb-3 filter-input" style="float: left; margin-left: 150px;">
        <label for="paper_meg_channel" class="form-label">Paper Meg Channel:</label>
        <input type="text" id="paper_meg_channel" name="paper_meg_channel" class="form-control"
          value="{{ filters.paper_meg_channel }}">
      </div>
      <div class="mb-3 filter-input" style="float: left; margin-left: 40px;">
        <label for="email" class="form-label">Email:</label>
        <input type="email" id="email" name="email" class="form-control" value="{{ filters.email }}">
      </div>

      <div class="mb-3 filter-input" style="float: left; margin-left: 40px;">
        <label for="phone_no" class="form-label">Phone Number:</label>
        <input type="text" id="phone_no" name="phone_no" class="form-control" value="{{ filters.phone_no }}">
      </div>
      <div class="mb-3 filter-input" style="float: left; margin-left: 40px;">
        <label for="remark" class="form-label">Remark:</label>
        <input type="text" id="remark" name="remark" class="form-control" value="{{ filters.remark }}">
      </div>
      <div class="mb-3 filter-input" style="float: right; margin-right: 120px;">
        <label for="executive" class="form-label">Executive:</label>
        <input type="text" id="executive" name="executive" class="form-control" value="{{ filters.executive }}">
      </div>
    </div>
    <div style="margin-top: 250px;">
      <button type="submit" class="btn btn-primary" style="margin-left: 50px;">Search</button>

    </div>

    <div class="table-container">
      <table class="table table-light mt-4" id="dataTable" style="overflow: auto;">
        <thead>
          <tr>
            <th>Select</th>
            {% for field in field_names %}
            <th>{{ field }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          {% for obj in queryset %}
          <tr>
            <td><input type="checkbox" name="selected_ids" value="{{ obj.id }}"></td>
            {% for field in field_names %}
            <td>{{ obj|getattr:field }}</td>
            {% endfor %}
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <h3 class="mt-4">Select fields to include in PDF:</h3>

    <div style="display: flex; flex-wrap: wrap; gap: 10px;">
      {% for field in field_names %}
      <div class="form-check" style="display: flex; align-items: center; margin-right: 15px;">
        <input class="form-check-input" type="checkbox" name="fields" value="{{ field }}" id="field-{{ field }}">
        <label class="form-check-label" for="field-{{ field }}" style="margin-left: 20px;">
          {{ field }}
        </label>
      </div>
      {% endfor %}

      <button type="submit" name="generate_pdf" class="btn btn-secondary">Download PDF</button>
    </div>

  </form>

</body>

</html>